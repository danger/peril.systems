# source: https://staging-api.peril.systems/api/graphql
# timestamp: Mon Apr 23 2018 16:06:37 GMT+0100 (BST)

"""An installation of Peril, ideally not too tightly tied to GH"""
type Installation {
  """The MongoDB ID"""
  id: String!

  """The installation ID, in the real sense"""
  iID: Int!

  """The path to the Dangerfile"""
  perilSettingsJSONURL: String!

  """The name of a user/org which the installation is attached to"""
  login: String!

  """A set of per repo rules"""
  repos: JSON!

  """Rules that are for all repos"""
  rules: JSON!

  """Scheduled tasks to run repeatedly"""
  scheduler: JSON!

  """Installation settings, for example ignored repos"""
  settings: JSON!

  """Tasks which you can schedule to run in the future"""
  tasks: JSON!
}

"""
Basically a way to say this is going to be untyped data (it's normally user input)
"""
scalar JSON

type Mutation {
  """
  Building this out incrementally, but basically this provides
  the ability to set the URL that Peril should grab data from
  """
  editInstallation(iID: Int!, perilSettingsJSONURL: String!): Installation
}

"""Root"""
type Query {
  me: User
}

"""Someone logged in to the API, all user data is stored inside the JWT"""
type User {
  """Display name"""
  name: String!

  """Use this to show an avatar"""
  avatarURL: String!

  """
  The installations that a user can access, TODO
  move to be a connection
  """
  installations: [Installation]!
}
